# Tenderduty configuration
# Generated by Ansible - DO NOT EDIT MANUALLY

enable_dashboard: true
listen_port: {{ tenderduty_port | default(8888) }}
hide_logs: false
prometheus_enabled: true
prometheus_listen_port: {{ tenderduty_prometheus_port | default(28686) }}

chains:
  "{{ chain_id }}":
    chain_id: "{{ chain_id }}"
    valoper_address: "{{ valoper_address }}"
    valcons_address: "{{ valcons_address | default('') }}"
    public_fallback: false

    alerts:
      # Alert when chain is stalled for more than 10 minutes
      stalled_enabled: true
      stalled_minutes: 10

      # Alert after 5 consecutive missed blocks
      consecutive_enabled: true
      consecutive_missed: 5
      consecutive_priority: critical

      # Alert when missed percentage exceeds 10% in the window
      percentage_enabled: true
      percentage_missed: 10
      percentage_priority: warning

      # Alert on tombstone
      tombstone_enabled: true
      tombstone_priority: critical

      # Alert when jailed
      jailed_enabled: true
      jailed_priority: critical

      # Alert when validator set changes
      active_set_enabled: true
      active_set_priority: warning

      # Alert on signing key change
      signing_key_change_enabled: true
      signing_key_change_priority: warning

    nodes:
      - url: "http://127.0.0.1:{{ rpc_port | default(26657) }}"
        alert_if_down: true

{% if enable_discord_alerts | default(false) %}
# Discord notification configuration
discord:
  enabled: true
  webhook: "{{ vault_discord_webhook_url }}"
  username: "Tenderduty"
  avatar_url: ""
{% endif %}

{% if enable_telegram_alerts | default(false) %}
# Telegram notification configuration
telegram:
  enabled: true
  api_key: "{{ vault_telegram_bot_token }}"
  channel: "{{ vault_telegram_chat_id }}"
{% endif %}

{% if enable_pagerduty_alerts | default(false) %}
# PagerDuty notification configuration
pagerduty:
  enabled: true
  api_key: "{{ vault_pagerduty_api_key }}"
{% endif %}

{% if enable_slack_alerts | default(false) %}
# Slack notification configuration
slack:
  enabled: true
  webhook: "{{ vault_slack_webhook_url }}"
{% endif %}
