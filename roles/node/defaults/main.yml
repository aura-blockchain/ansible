---
# AURA Node Role - Default Variables
#
# IMPORTANT: Chain-level constants are defined in group_vars/chain.yml
# These defaults reference chain.yml values where appropriate.
# Override per-host values in inventory, not here.

# Go installation (references chain.yml go_version)
node_go_version: "{{ go_version | default('1.23.0') }}"
node_go_arch: "{{ 'arm64' if ansible_architecture == 'aarch64' else 'amd64' }}"
node_go_download_url: "https://go.dev/dl/go{{ node_go_version }}.linux-{{ node_go_arch }}.tar.gz"

# Cosmovisor (references chain.yml cosmovisor_version)
node_cosmovisor_version: "{{ cosmovisor_version | default('v1.5.0') }}"

# Daemon configuration (references chain.yml)
node_daemon_name: "{{ daemon_name | default('aurad') }}"
node_daemon_user: "{{ daemon_user | default('ubuntu') }}"
node_daemon_group: "{{ daemon_group | default('ubuntu') }}"
node_daemon_home: "/home/{{ node_daemon_user }}/.aura-mvp-{{ node_name }}"

# Chain configuration (references chain.yml)
node_chain_id: "{{ chain_id | default('aura-mvp-1') }}"
node_bech_prefix: "{{ chain_bech32_prefix | default('aura') }}"
node_staking_denom: "{{ chain_staking_denom | default('uaura') }}"
node_name: "val1"
node_type: "val"  # val or sentry
node_number: 1

# Network ports (references chain.yml ports object as defaults)
node_rpc_port: "{{ ports.rpc | default(26657) }}"
node_p2p_port: "{{ ports.p2p | default(26656) }}"
node_grpc_port: "{{ ports.grpc | default(9090) }}"
node_api_port: "{{ ports.api | default(1317) }}"
node_pprof_port: "{{ ports.pprof | default(6060) }}"

# Artifact URLs (references chain.yml)
node_genesis_url: "{{ genesis_url | default('https://artifacts.aurablockchain.org/' + chain_id + '/genesis.json') }}"
node_peers_url: "{{ peers_url | default('https://artifacts.aurablockchain.org/' + chain_id + '/peers.txt') }}"

# Binary source (set one of these)
node_binary_url: ""  # URL to download aurad binary
node_binary_path: "/tmp/aurad"  # Local path to aurad binary

# Node configuration
node_moniker: "{{ node_name }}"
node_minimum_gas_prices: "0.025uaura"

# Pruning configuration
node_pruning: "default"
node_pruning_keep_recent: "100"
node_pruning_keep_every: "0"
node_pruning_interval: "10"

# =============================================================================
# P2P Configuration
# =============================================================================
node_persistent_peers: ""
node_private_peer_ids: ""
node_pex_enabled: true  # Legacy variable, use node_pex instead
node_addr_book_strict: false  # false allows private IP connections
node_max_num_inbound_peers: 40
node_max_num_outbound_peers: 10

# Validator-specific (for sentry nodes to list validator IDs)
node_validator_node_ids: []

# =============================================================================
# Validator/Sentry Hermit Rules (cosmos-validator-and-sentry-rules.txt)
# =============================================================================
# These defaults are SAFE for validators (hermit mode).
# Override in inventory for sentries with public-facing values.
#
# RULE: Validators are "hermits" - they only sign blocks, no public services
# RULE: Sentries run public services and protect validators from DDoS

# Network binding addresses
# Validators: 127.0.0.1 (localhost only - hermit rule)
# Sentries: 0.0.0.0 (public access) - override in inventory
node_rpc_bind: "127.0.0.1"
node_api_bind: "127.0.0.1"
node_grpc_bind: "127.0.0.1"

# Peer exchange (pex)
# Validators: false (do not discover public peers)
# Sentries: true (discover public peers) - override in inventory
node_pex: false

# API configuration
# Validators: false (hermit rule - no public services)
# Sentries: true (public access) - override in inventory
node_api_enabled: false
node_api_swagger: false

# gRPC configuration
# Validators: false (hermit rule - no public services)
# Sentries: true (public access) - override in inventory
node_grpc_enabled: false

# Prometheus metrics
node_prometheus_enabled: true
node_prometheus_port: 26660
node_prometheus_listen_addr: ":{{ node_prometheus_port }}"

# Cosmovisor environment
node_cosmovisor_allow_download_binaries: false
node_cosmovisor_restart_after_upgrade: true
node_cosmovisor_log_buffer_size: 512

# Firewall
node_configure_firewall: true
node_vpn_network: "10.10.0.0/24"

# Service management
node_service_enabled: true
node_service_state: "started"
